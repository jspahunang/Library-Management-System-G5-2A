<div class="page-section">
  <h2 class="page-title">Book Catalog</h2>

  <div class="flex flex-wrap gap-4 catalog__search-row">
    <div class="catalog__search-wrap">
      <span class="catalog__search-icon" aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
      </span>
      <input
        type="search"
        placeholder="Search by title, author, ISBN, category..."
        class="input catalog__search flex-1"
        [value]="searchQuery()"
        (input)="onSearch($any($event.target).value)"
      />
    </div>
  </div>

  @if (message()) {
    <div
      class="alert"
      [class.alert-error]="message().startsWith('Invalid') || message().startsWith('No')"
      [class.alert-success]="message().includes('success')"
    >
      {{ message() }}
    </div>
  }

  <div class="book-grid">
    @for (book of books(); track book.bookid) {
      <div class="book-card">
        <h3 class="book-card-title">{{ book.booktitle }}</h3>
        <p class="book-card-meta">{{ book.author }}</p>
        <p class="book-card-meta-sm">{{ book.category }} Â· ISBN {{ book.isbn }}</p>
        <p class="book-card-meta">Available: {{ book.availableCopies }} / {{ book.totalCopies }}</p>
        @if (book.availableCopies > 0 && studentId()) {
          <div class="book-card-actions">
            <button type="button" (click)="borrow(book.bookid)" class="btn btn-primary">Borrow</button>
          </div>
        }
      </div>
    } @empty {
      <p class="empty-msg col-span-full">No books found.</p>
    }
  </div>
</div>
